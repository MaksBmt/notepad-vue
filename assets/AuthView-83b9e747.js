import E from"./HomeView-d3b6d2a8.js";import{_ as C,r as i,u as F,a as I,b as N,w as h,c as B,o as f,d as T,e as l,f as a,g as x,h as s,i as j,n as q,j as V,t as M,k as P,s as U,p as $,l as z,F as D}from"./index-6d9278c7.js";import{A as H,a as R,b as y,c as G,d as J,v as K,e as A}from"./validator-86c9a7ec.js";const c=n=>($("data-v-36828c1c"),n=n(),z(),n),L=["onSubmit"],O={class:"form__wrap"},Q=c(()=>s("label",{class:"form__label",for:"email"},"Email",-1)),W={class:"form__wrap"},X=c(()=>s("label",{class:"form__label",for:"password"},"Пароль",-1)),Y={class:"form__wrap"},Z={class:"form__box"},ee=c(()=>s("span",{class:"form__text"},"У вас нет аккаунта?",-1)),se=c(()=>s("span",{class:"form__text form__text--green"},"Зарегистрируйтесь",-1)),ae={key:0,class:"form__server",role:"alert"},oe=!0,te={__name:"FormAuth",setup(n){const v=()=>({email:{error:"",rules:["required","email"]},password:{error:"",rules:["required"]}}),t=i(""),u=i(""),r=i(v()),p=F(),b=I(),o=i(null),d=i(!0),S=N(),g=({target:e})=>{d.value=!d.value,e.nextElementSibling.type==="password"?e.nextElementSibling.type="text":e.nextElementSibling.type="password"};h(t,()=>{o.value&&(o.value=null),r.value.email.error&&A(r.value)}),h(u,()=>{o.value&&(o.value=null),r.value.password.error&&A(r.value)});async function k(){if(!K({email:t.value,password:u.value},r.value))return;const e=await p.auth(t.value,u.value);(e==null?void 0:e.statusCode)>=400?Array.isArray(e.message)?o.value=e.message.join(", "):o.value=e.message:(U(e.accessToken),p.isAuthenticated=!0,p.user.email=t.value,b.getNotes(),S.push("/notes"))}return(e,_)=>{const w=B("router-link");return f(),T(J,{class:"form"},{default:l(()=>[a(w,{to:"/",title:"закрыть"},{default:l(()=>[a(H,{class:"form__close"})]),_:1}),a(R,{class:"form__title"},{default:l(()=>[x("Вход в ваш аккаунт")]),_:1}),s("form",{class:"form__form",onSubmit:j(k,["prevent"])},[s("div",O,[Q,a(y,{id:"email",modelValue:t.value,"onUpdate:modelValue":_[0]||(_[0]=m=>t.value=m),type:"email",name:"email",class:"form__input",placeholder:"E-mail",autocomplete:"email","error-text":r.value.email.error},null,8,["modelValue","error-text"])]),s("div",W,[X,a(y,{id:"password",modelValue:u.value,"onUpdate:modelValue":_[1]||(_[1]=m=>u.value=m),type:"password",autocomplete:"current-password",name:"password",class:q(["form__input",[d.value?"input--password-close":"input--password-open"]]),placeholder:"Пароль","error-text":r.value.password.error,"is-password":oe,onAction:g},null,8,["modelValue","class","error-text"])]),s("div",Y,[a(G,{class:"form__button",type:"submit"},{default:l(()=>[x("Войти")]),_:1}),s("div",Z,[ee,a(w,{to:"/reg",class:"form__link",title:"перейти в форму регистрации"},{default:l(()=>[se]),_:1})])])],40,L),o.value?(f(),V("p",ae,M(o.value),1)):P("",!0)]),_:1})}}},re=C(te,[["__scopeId","data-v-36828c1c"]]);const le=s("div",{class:"overlay"},null,-1),_e={__name:"AuthView",setup(n){return(v,t)=>(f(),V(D,null,[le,a(E,null,{default:l(()=>[a(re)]),_:1})],64))}};export{_e as default};
